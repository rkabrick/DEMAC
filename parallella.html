<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2018-07-25 Wed 15:55 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="rkabrick" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgf305fa6">1. Setting Up a Parallella Cluster on Linux</a>
<ul>
<li><a href="#orgcf8e989">1.1. Preliminaries</a>
<ul>
<li><a href="#org07f3d39">1.1.1. Required Materials</a></li>
<li><a href="#org2c17824">1.1.2. Setting up master SD Card</a></li>
<li><a href="#orgd34d7ca">1.1.3. Setting up Network (Router + Switch)</a></li>
</ul>
</li>
<li><a href="#orgd0de180">1.2. Connecting to Your Parallella</a></li>
<li><a href="#org4d2c1d6">1.3. Installing Software</a>
<ul>
<li><a href="#org847ef18">1.3.1. Updating Archives</a></li>
<li><a href="#org4d7b0a2">1.3.2. MPICH</a></li>
<li><a href="#org0501cdd">1.3.3. Ansible</a></li>
</ul>
</li>
<li><a href="#org3547c48">1.4. Setting Up Remaining Nodes</a>
<ul>
<li><a href="#orgd73b303">1.4.1. Copying OS to SD Cards</a></li>
<li><a href="#org09f12fd">1.4.2. Board Configuration (Static IP, Hostname, RSA keys)</a></li>
<li><a href="#orgb7d3810">1.4.3. MPI Configuration</a></li>
</ul>
</li>
<li><a href="#org4c1397c">1.5. Running Your First Program with MPI</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgf305fa6" class="outline-2">
<h2 id="orgf305fa6"><span class="section-number-2">1</span> Setting Up a Parallella Cluster on Linux</h2>
<div class="outline-text-2" id="text-1">
<p>
This is a guide on how to properly configure a parallella cluster of 4 nodes. The steps listed should
apply to a cluster of more than just 4 nodes or less.
</p>
</div>
<div id="outline-container-orgcf8e989" class="outline-3">
<h3 id="orgcf8e989"><span class="section-number-3">1.1</span> Preliminaries</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-org07f3d39" class="outline-4">
<h4 id="org07f3d39"><span class="section-number-4">1.1.1</span> Required Materials</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
For each board you need the following materials
</p>
<ul class="org-ul">
<li>Micro USB Power Cable</li>
<li>Micro SD Cards (&ge;8Gb)</li>
<li>A nice Columbian guy to 3D Print a kick ass rack mount for the boards</li>
<li>Fan (Optional)</li>
<li>Router</li>
<li>Switch (Optional)</li>
</ul>
</div>
</div>

<div id="outline-container-org2c17824" class="outline-4">
<h4 id="org2c17824"><span class="section-number-4">1.1.2</span> Setting up master SD Card</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
Although it should go without saying, you have to use a computer that will not be in the cluster to prep SD Cards
</p>

<p>
1.) Download whichever operating system you would like (Headless vs HDMI Support) from <a href="https://www.parallella.org/create-sdcard/">here</a>
2.) Navigate to your Downloads Directory
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> Downloads
</pre>
</div>
<p>
3.) Extract the File
</p>
<div class="org-src-container">
<pre class="src src-sh">gunzip -k parabuntu-2016.11.1-headless-z7010.img.gz
</pre>
</div>
<p>
4.) Figure out where your SD Card is on the machine&#x2026; It helps to look at the output of this function by volume space.
</p>
<div class="org-src-container">
<pre class="src src-sh">lsblk
</pre>
</div>

<p>
For me, it was located at <b>/dev/mmcblk0</b>
</p>

<p>
5.) Write the image to the SD Card
</p>
<div class="org-src-container">
<pre class="src src-sh">sudo dd <span style="color: #DFAF8F;">bs</span>=4M <span style="color: #DFAF8F;">if</span>=<span style="color: #DFAF8F;">parabuntu</span>=2016.11.1-headless-z7010.img <span style="color: #DFAF8F;">of</span>=/dev/mmcblk0 <span style="color: #DFAF8F;">bs</span>=64k
</pre>
</div>

<p>
6.) Load SD Card in Parallella
</p>
</div>
</div>

<div id="outline-container-orgd34d7ca" class="outline-4">
<h4 id="orgd34d7ca"><span class="section-number-4">1.1.3</span> Setting up Network (Router + Switch)</h4>
<div class="outline-text-4" id="text-1-1-3">
<p>
The following instructions will detail how to set up your network so you can easily ssh
into the headless OS
</p>

<p>
1.) Connect the one Parallella that should have an OS now to the router
2.) Login to your routers configuration page by typing the IP Address of the router
to your web browser. It should look something like this&#x2026;
</p>

<p>
<a href="file:///home/rkabrick/Pictures/Screenshot%20from%202018-07-25%2013-23-09.png">Router Interface</a>
</p>

<p>
You need to know the login information for the router. If you are using a router that has
been previously set up look up how to set it back to factory defaults and use the default
login to access the page.
</p>

<p>
3.) Navigate to the <b>Network</b> tab
4.) Click on DCHP Client List to see a list of IP's given out by the router
5.) Look for an entry in this list titled <b>Parallella</b>
6.) Make a note of that IP Address
</p>
</div>
</div>
</div>

<div id="outline-container-orgd0de180" class="outline-3">
<h3 id="orgd0de180"><span class="section-number-3">1.2</span> Connecting to Your Parallella</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Now that you have the IP Address we can finally ssh into our board and begin configuring the software side of the cluster
</p>

<p>
1.) Open a terminal (Main computer not parallella)
2.) ssh into your board using the default username and password for the parabuntu OS
</p>

<p>
The skeleton for this command is&#x2026;
<i>ssh hostname @ IP Address</i>
</p>


<p>
<i>hostname: parallella</i>
<i>Password: parallella</i>
</p>

<div class="org-src-container">
<pre class="src src-sh">ssh parallella@192.168.10.103
</pre>
</div>

<p>
3.) Follow the prompts and if all went well, you should be greeted with a login message
</p>
</div>
</div>

<div id="outline-container-org4d2c1d6" class="outline-3">
<h3 id="org4d2c1d6"><span class="section-number-3">1.3</span> Installing Software</h3>
<div class="outline-text-3" id="text-1-3">
<p>
The following instructions are to be completed on the parallella board not your own computer
</p>
</div>
<div id="outline-container-org847ef18" class="outline-4">
<h4 id="org847ef18"><span class="section-number-4">1.3.1</span> Updating Archives</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
Parabuntu is built on an Ubuntu 15 distribution. This means that it will not be able to access
anything <i>apt-get</i> related by default
</p>

<p>
You should not be able to successfully run the following command without a lot of errors:
</p>
<div class="org-src-container">
<pre class="src src-sh">sudo apt-get update
</pre>
</div>

<p>
In order to link the old sources to the parallella you need to run the following command:
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo sed -i -re <span style="color: #CC9393;">'s/([a-z]{2}\.)?archive.ubuntu.com|security.ubuntu.com/old-releases.ubuntu.com/g'</span> /etc/apt/sources.list
</pre>
</div>

<p>
Now you should be able to run sudo apt-get update with minimal errors. Don't be discouraged if there are a few
sources that still return errors&#x2026; just as long as it is noticeably less than the initial <i>sudo apt-get update</i>
before the <b>sed</b> command.
</p>
</div>
</div>

<div id="outline-container-org4d7b0a2" class="outline-4">
<h4 id="org4d7b0a2"><span class="section-number-4">1.3.2</span> MPICH</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
1.) Download MPICH2
</p>
<div class="org-src-container">
<pre class="src src-sh">wget http://www.mpich.org/static/download/3.1/mpich-3.1.tar.gz
</pre>
</div>

<p>
2.) Navigate to the directory containing the file and extract it
</p>
<div class="org-src-container">
<pre class="src src-sh">tar -xvf mpich-3.1.tar.gz
</pre>
</div>

<p>
3.) cd Into the MPICH Folder
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #DCDCCC; font-weight: bold;">cd</span> mpich-3.1
</pre>
</div>

<p>
4.) Run the Configuration (This may take a bit)
</p>
<div class="org-src-container">
<pre class="src src-sh">./configure
</pre>
</div>

<p>
When the configuration is done you should get a <i>Configuration Complete</i> message
</p>

<p>
5.) Build MPICH (This will also take a while)
</p>

<div class="org-src-container">
<pre class="src src-sh">make; sudo make install
</pre>
</div>

<p>
If your build was successful you should be able to type <b>mpiexec &#x2013;version</b> and get
a response with the current version of mpi installed on your hardware.
</p>

<p>
6.) Make and edit <b>machinefile</b> in your home directory
</p>
<div class="org-src-container">
<pre class="src src-sh">sudo vim machinefile
</pre>
</div>

<p>
You want the file to have all of the static IP Addresses you are going to want to use for each board
in your cluster. Because I will be using 4 boards I will have 4 entries in this file.
</p>

<p>
For example, my <b>machinefile</b> looks like this:
</p>
<pre class="example">
parallella@192.168.10.101
parallella@192.168.10.102
parallella@192.168.10.103
parallella@192.168.10.104
</pre>
</div>
</div>
<div id="outline-container-org0501cdd" class="outline-4">
<h4 id="org0501cdd"><span class="section-number-4">1.3.3</span> Ansible</h4>
<div class="outline-text-4" id="text-1-3-3">
<p>
1.) Install Ansible
</p>
<div class="org-src-container">
<pre class="src src-sh">sudo apt-get update
sudo apt-get install ansible
</pre>
</div>

<p>
2.) Create a cluster.ini file and put just the IP Addresses you will be using for the machines in the cluster
</p>
<div class="org-src-container">
<pre class="src src-sh">vim cluster.ini
</pre>
</div>

<p>
My cluster.ini file has this information:
</p>
<pre class="example">
192.168.10.101
192.168.10.102
192.168.10.103
192.168.10.104
</pre>
</div>
</div>
</div>
<div id="outline-container-org3547c48" class="outline-3">
<h3 id="org3547c48"><span class="section-number-3">1.4</span> Setting Up Remaining Nodes</h3>
<div class="outline-text-3" id="text-1-4">
<p>
So far we have only been working with one of our parallellas. Now it is time to bring in the
remaining nodes.
</p>
</div>

<div id="outline-container-orgd73b303" class="outline-4">
<h4 id="orgd73b303"><span class="section-number-4">1.4.1</span> Copying OS to SD Cards</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
To avoid having to install all of the software on each node again we will read the current image on
our first SD card and back it up to our computer (Not Parallella). Then, instead of loading
the default parabuntu image we will load our modified version with all of the necessary software
already installed.
</p>

<p>
1.) Take the SD Card out of the parallella and connect it to your own computer.It should mount
itself at the same location we used to initially write to the card (/dev/mmcblk0)
</p>

<p>
2.) Now open a terminal and issue the following command to copy the image from the card
</p>
<div class="org-src-container">
<pre class="src src-sh">sudo dd <span style="color: #DFAF8F;">if</span>=/dev/mmcblk0 <span style="color: #DFAF8F;">of</span>=~/parallellaMaster.img
</pre>
</div>

<p>
3.) Now its time to copy the image to the remaining unused SD Cards. Insert each SD card one at a
time and use the command below to transfer the img to the card.
</p>
<div class="org-src-container">
<pre class="src src-sh">sudo dd <span style="color: #DFAF8F;">bs</span>=4M <span style="color: #DFAF8F;">if</span>=~/parallellaMaster.img <span style="color: #DFAF8F;">of</span>=/dev/mmcblk0
</pre>
</div>

<p>
Steps 2 and 3 will take some time but we will save more time by not going through the software
installation for every board.
</p>
</div>
</div>

<div id="outline-container-org09f12fd" class="outline-4">
<h4 id="org09f12fd"><span class="section-number-4">1.4.2</span> Board Configuration (Static IP, Hostname, RSA keys)</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
Now we have four SD cards that have identical contents
</p>

<p>
1.) Power on the first parallella
</p>

<p>
2.) ssh into the board
</p>
<div class="org-src-container">
<pre class="src src-sh">ssh parallella@192.168.10.103
</pre>
</div>
<p>
It is crucial that you only power on one of the boards at a time because they all have the same
configuration and it may prove difficult to login to them all at this point in time.
</p>
</div>
<ol class="org-ol">
<li><a id="orgba9534c"></a>Hosts Configuration<br />
<div class="outline-text-5" id="text-1-4-2-1">
<p>
3.) Edit the hosts file
</p>
<div class="org-src-container">
<pre class="src src-sh">sudo vim /etc/hosts
</pre>
</div>

<p>
This will be a list of hosts matched to their ip address and hostname. You want to add lines
with your desired static IP Addresses for the boards. I added the following lines based on the
static IPs I want my boards to have:
</p>
<pre class="example">
192.168.10.101 pnode1
192.168.10.102 pnode2
192.168.10.103 pnode3
192.168.10.104 pnode4
</pre>
<p>
4.) Edit the <b>hostname</b> file
</p>
<div class="org-src-container">
<pre class="src src-sh">sudo vim /etc/hostname
</pre>
</div>

<p>
Change the hostname to your desired name. I will use <b>pnode1</b> because that is what I specified
in the hosts file
</p>

<p>
5.) Edit the eth0 file
</p>
<div class="org-src-container">
<pre class="src src-sh">sudo vim /etc/network/interfaces.d/eth0
</pre>
</div>

<p>
You should add/modify the file so it reads as follows:
</p>
<pre class="example">
auto eth0
iface eth0 inet static
address 192.168.10.101
netmask 255.255.255.0
gateway 192.168.10.1
nameserver 8.8.8.8
nameserver 8.8.4.4
</pre>

<p>
Where:
</p>
<pre class="example">
*address* corresponds to your desired static IP
*gateway* corresponds to your routers default gateway
*nameserver* is any server you want to be able to use... the 8.8.8.8 and 8.8.4.4 corresponds to google's
</pre>
<p>
6.) Now power off the board and power it back on so it uses the static IP and hostname you set in the previous
steps
</p>

<p>
7.) You should be able to ssh into all of your nodes at this point. If you cannot make sure you correctly configured
the static IPs and do not have any duplicates.
</p>
</div>
</li>

<li><a id="org2cb1928"></a>RSA Keys<br />
<div class="outline-text-5" id="text-1-4-2-2">
<p>
In order to use these boards simultaneously you will have to enable passwordless login so that each node
is able to login to the rest of the nodes. The easiest way to do this is to generate RSA keypair and copy
each public key to the other boards.
</p>

<p>
1.) While in the home directory of the parallella generate keys.
</p>
<div class="org-src-container">
<pre class="src src-sh">ssh-keygen -t rsa
</pre>
</div>

<p>
2.) Follow the prompts and DO NOT enable a passphrase. You should just be hitting enter 2-3 times so you have
the default settings for everything.
</p>

<p>
3.) Copy the RSA key to the remaining nodes. To make sure you don't forget any nodes I would ssh-copy-id to every
node in the cluster, even the one I am using. This is not necessary but it's just a precautionary measure to avoid
making the mistake of not copying the key to all of the clients.
</p>

<div class="org-src-container">
<pre class="src src-sh">ssh-copy-id parallella@192.168.10.101
ssh-copy-id parallella@192.168.10.102
ssh-copy-id parallella@192.168.10.103
ssh-copy-id parallella@192.168.10.104
</pre>
</div>

<p>
4.) You should now be able to ssh from your current parallella to the rest in the cluster without a password. Make sure
when connecting to the other nodes for the first time that you respond <b>yes</b> when prompted to add the boards to the list
of known hosts. In order to correctly implement MPI, the boards need to have the history of connection to that board.
</p>

<p>
Basically you need to make sure that the keys get added to the authorized key lists which should happen by default with
the <b>ssh-copy-id</b> command.
</p>

<p>
It is also VERY IMPORTANT when using the ssh-copy-id function to input the right user that you want to have access to.
For example, if I only put the IP address without the <i>parallella</i> username, the keys will not be copied to the right
user and will therefore not work properly with MPI.
</p>

<p>
5.) Repeat steps 1-4 on the rest of the nodes in the cluster
</p>
</div>
</li>
</ol>
</div>






<div id="outline-container-orgb7d3810" class="outline-4">
<h4 id="orgb7d3810"><span class="section-number-4">1.4.3</span> MPI Configuration</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
At this point you should be able to ssh into all nodes from all nodes and not be greeted with anything besides
a login successful message. There should be no prompts asking if you would like to authenticate the host you're
trying to connect to.
</p>

<p>
1.) Run the following command on one of the nodes (I will use pnode1)
</p>
<div class="org-src-container">
<pre class="src src-sh">mpiexec -machinefile machinefile -n 1 hostname
</pre>
</div>

<p>
and it should return the name of the current host.
</p>

<p>
2.) Lets see if the other nodes are correctly configured
</p>
<div class="org-src-container">
<pre class="src src-sh">mpiexec -machinefile machinefile -n 8 hostname
</pre>
</div>

<p>
You should see a list of all of the hostnames each pinged twice. It should look something like this:
</p>
<pre class="example">
pnode1
pnode1
pnode2
pnode2
pnode3
pnode3
pnode4
pnode4
</pre>

<p>
If you do not see a list that includes all of the hosts then you have completed a step incorrectly and should backtrack
to find your error.
</p>

<p>
If you get an error with several bullet points about possible errors you have not correctly copied the RSA keys from
EVERY node to EVERY node. You likely forgot to copy the keys to each board. Like I have said several times so far&#x2026;
It is absolutely necessary that you can ssh from nodes 1-4 to every other node in the cluster without getting any
prompts from the shell.
</p>
</div>
</div>
</div>

<div id="outline-container-org4c1397c" class="outline-3">
<h3 id="org4c1397c"><span class="section-number-3">1.5</span> Running Your First Program with MPI</h3>
<div class="outline-text-3" id="text-1-5">
<p>
Now that all of the nodes are correctly configured and have all of the right files we are ready to
try running our first program on our cluster computer.
</p>

<p>
1.) Get the premade Python file on one of the nodes
</p>
<div class="org-src-container">
<pre class="src src-sh">wget http://www.tinkernut.com/demos/364_cluster_comp/python_test.tar.gz
</pre>
</div>

<p>
2.) Extract the file
</p>
<div class="org-src-container">
<pre class="src src-sh">tar -xzf python_test.tar.gz
</pre>
</div>

<p>
3.) Edit the file so it can run properly
</p>
<div class="org-src-container">
<pre class="src src-sh">vim python_test/md5_attack.py
</pre>
</div>

<p>
While editing this file you want to change the 3rd line: <b>dict<sub>file</sub></b>
</p>

<p>
Change the file so the third line reads:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #DFAF8F;">dict_file</span> = <span style="color: #CC9393;">"/home/parallella/python_test/dict.txt"</span>
</pre>
</div>

<p>
4.) Copy the folder to the remaining nodes in the cluster so they can run it as well
</p>
<div class="org-src-container">
<pre class="src src-sh">scp -r python_test 192.168.10.102:/home/parallella
scp -r python_test 192.168.10.103:/home/parallella
scp -r python_test 192.168.10.104:/home/parallella
</pre>
</div>

<p>
5.) Finally run the program
</p>
<div class="org-src-container">
<pre class="src src-sh">mpiexec -f machinefile -n 1 python python_test/md5_attack.py
</pre>
</div>

<p>
You should successfully run the program very quickly with the combined resources of the boards.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: rkabrick</p>
<p class="date">Created: 2018-07-25 Wed 15:55</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
